{"nameSortList":["node_433f571489caf39d3c60e483ff5","node_d2912064fc196e95e2f5bbd7df8","node_fcfe7f74d22b73bae595c6100c3","node_ac9b97b4deabf398327881a7415","node_1a0e4e14d4db4f3f2db0fddfd87"],"endNodeName":"node_2afcb7245888ac9984ca3603f39","displayName":"cve漏洞订阅","playbookCategory":"COMMONEVENT","description":"{\"blocks\":[{\"key\":\"a95d5\",\"text\":\"cve漏洞订阅：\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"b9i5t\",\"text\":\"1、配置你关注的组件，如redis。（多个使用英文逗号分隔）\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"6qvhd\",\"text\":\"2、配置钉钉机器人。\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"arhud\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"42kts\",\"text\":\"其他：\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"fvot0\",\"text\":\"数据来源：Red Hat Security Data API\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"offset\":5,\"length\":25,\"key\":0}],\"data\":{}},{\"key\":\"ai02n\",\"text\":\"1、默认获取最近1天的漏洞数据。\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{\"nodeAttributes\":{}}},{\"key\":\"26hcu\",\"text\":\"2、配置定时任务每天运行一次。\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{\"nodeAttributes\":{}}},{\"key\":\"56qvh\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{\"nodeAttributes\":{}}},{\"key\":\"cv6eo\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"9951g\",\"text\":\"剧本逻辑\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"uvn0\",\"text\":\"1、获取关注的组件\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"11n0t\",\"text\":\"2、通过接口查询cve漏洞库里面组件漏洞信息\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"g82e\",\"text\":\"3、定位漏洞详情\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"8ttjr\",\"text\":\"4、处理数据格式发送出去\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{\"0\":{\"type\":\"LINK\",\"mutability\":\"MUTABLE\",\"data\":{\"href\":\"https://access.redhat.com/documentation/en-us/red_hat_security_data_api/1.0/html/red_hat_security_data_api/index\",\"target\":\"_blank\"}}}}","endNodeId":9626158175256171,"startNodeName":"node_7d310db4c18aef69f3e8945aa47","labels":[],"startNodeId":9626158175125325,"name":"playbook_1deeb6e7c9c01ce06645de1dd20c6194","id":9591760531056481,"drawJson":{"cells":[{"router":{"name":"manhattan"},"connector":{"name":"rounded"},"z":-1,"source":{"port":"2cc9e943-b7f9-4f20-bbdc-6d35aebb4f02","id":"4323a7d3-10db-4c18-aef6-9f3e8945aa47","magnet":"portBody"},"id":"7860c39f-ffce-4901-895b-482000cf472f","type":"standard.Link","target":{"port":"208d26f8-f7fc-4f84-94c0-ca0947ae9b8b","id":"cfa15433-f571-489c-af39-d3c60e483ff5"},"attrs":{"line":{"stroke":"rgb(111,122,136)"}}},{"router":{"name":"manhattan"},"connector":{"name":"rounded"},"z":-1,"source":{"port":"e350a9ef-8093-4565-bfdc-d7a9df7311d5","id":"146791a0-e4e1-4d4d-b4f3-f2db0fddfd87","magnet":"portBody"},"id":"27e892c3-f47f-4364-b02f-0cd24834dcb3","type":"standard.Link","target":{"port":"ab2f64b5-8748-450e-92d9-3ea2282e28cd","id":"914032af-cb72-4588-8ac9-984ca3603f39","magnet":"portBody"},"attrs":{"line":{"stroke":"rgb(111,122,136)"}}},{"router":{"name":"manhattan"},"connector":{"name":"rounded"},"z":-1,"source":{"port":"e9728186-67bb-4df0-bc4c-631602545feb","id":"036ceac9-b97b-4dea-bf39-8327881a7415","magnet":"portBody"},"id":"645d1710-9238-4bfe-bf3c-9d0088e3e8ca","type":"standard.Link","target":{"port":"fa1fbb18-074a-48c2-a2de-cedc4b13c988","id":"146791a0-e4e1-4d4d-b4f3-f2db0fddfd87","magnet":"portBody"},"attrs":{"line":{"stroke":"rgb(111,122,136)"}}},{"router":{"name":"manhattan"},"connector":{"name":"rounded"},"z":-1,"source":{"port":"a85f8e9b-ea21-4560-9f08-428ae79033c1","id":"c55ead29-1206-4fc1-96e9-5e2f5bbd7df8","magnet":"portBody"},"id":"a92ca68a-fa03-4b84-ad52-722db88521a1","type":"standard.Link","target":{"port":"88f8b2f3-af87-4f46-ac08-ce34e7a3da3a","id":"4f982fcf-e7f7-4d22-b73b-ae595c6100c3"},"attrs":{"line":{"stroke":"rgb(111,122,136)"}}},{"router":{"name":"manhattan"},"connector":{"name":"rounded"},"z":-1,"source":{"port":"daf29d9f-0fe8-4dbf-8111-496955b914da","id":"4f982fcf-e7f7-4d22-b73b-ae595c6100c3","magnet":"portBody"},"id":"8a6d8d2b-6ee0-4143-bd17-89fc1ffc4863","type":"standard.Link","target":{"port":"ff64873f-4a05-4334-9a45-14cf2e85f604","id":"036ceac9-b97b-4dea-bf39-8327881a7415","magnet":"portBody"},"labels":[{"markup":[{"selector":"body","tagName":"rect"},{"selector":"label","tagName":"text"}],"position":{"distance":0.2,"offset":{"x":10,"y":-11}},"attrs":{"label":{"transform":"matrix(1, 0, 0, 1, 7, 3)","text":"数值=1","fill":"#fff"},"body":{"rx":3,"ry":3,"width":60,"fill":"#00b5ad","height":20}}}],"attrs":{"condition":{"paramDataPath":"node_fcfe7f74d22b73bae595c6100c3:RuleExecResult.level","param":{"valueType":"INTEGER","description":"数值","realPath":"node_fcfe7f74d22b73bae595c6100c3:RuleExecResult.level","label":"数值","dataPath":"RuleExecResult.level"},"configOk":true,"valueType":"INTEGER","name":"8a6d8d2b-6ee0-4143-bd17-89fc1ffc4863","paramLabel":"数值","label":"数值=1","type":"CONDITION","value":"1"},"line":{"stroke":"rgb(111,122,136)"}}},{"router":{"name":"manhattan"},"connector":{"name":"rounded"},"z":-1,"source":{"port":"2e7ca64c-bd88-4c71-bc90-4a25a6900270","id":"cfa15433-f571-489c-af39-d3c60e483ff5","magnet":"portBody"},"id":"e1210e45-76b6-4bcf-925f-12ae9878a96f","type":"standard.Link","target":{"port":"660b0e79-624d-47dc-ac4e-d251c5fcf759","id":"c55ead29-1206-4fc1-96e9-5e2f5bbd7df8","magnet":"portBody"},"attrs":{"line":{"stroke":"rgb(111,122,136)"}}},{"size":{"width":120,"height":60},"markup":[{"selector":"background","tagName":"rect"},{"selector":"header","tagName":"rect"},{"selector":"cover","tagName":"rect"},{"selector":"border","tagName":"rect"},{"selector":"title","tagName":"text"},{"selector":"icon","tagName":"image"},{"selector":"icon1","tagName":"image"},{"selector":"label","tagName":"text"}],"angle":0,"z":1,"position":{"x":50,"y":160},"id":"4323a7d3-10db-4c18-aef6-9f3e8945aa47","type":"START","ports":{"groups":{"out":{"markup":[{"selector":"portBody","tagName":"circle"}],"size":{"width":20,"height":20},"z":0,"position":{"args":{"x":133,"y":40},"name":"right"},"attrs":{"portBody":{"r":9,"transform":"translate(-10,-10)","fill":"#21ba45","magnet":true}}}},"items":[{"id":"2cc9e943-b7f9-4f20-bbdc-6d35aebb4f02","group":"out"}]},"group":null,"attrs":{}},{"size":{"width":120,"height":60},"markup":[{"selector":"background","tagName":"rect"},{"selector":"header","tagName":"rect"},{"selector":"cover","tagName":"rect"},{"selector":"border","tagName":"rect"},{"selector":"title","tagName":"text"},{"selector":"icon","tagName":"image"},{"selector":"label","tagName":"text"},{"selector":"btnStar","tagName":"image"}],"angle":0,"z":2,"position":{"x":1190,"y":160},"id":"914032af-cb72-4588-8ac9-984ca3603f39","type":"END","ports":{"groups":{"in":{"markup":[{"selector":"portBody","tagName":"circle"}],"size":{"width":20,"height":20},"z":0,"position":{"args":{"x":6,"y":40},"name":"right"},"attrs":{"portBody":{"r":9,"transform":"translate(-10,-10)","fill":"#5094D4","magnet":"passive"}}},"out":{"markup":[{"selector":"portBody","tagName":"circle"}],"size":{"width":20,"height":20},"z":0,"position":{"args":{"x":133,"y":40},"name":"right"},"attrs":{"portBody":{"r":9,"transform":"translate(-10,-10)","fill":"#21ba45","magnet":true}}}},"items":[{"id":"ab2f64b5-8748-450e-92d9-3ea2282e28cd","group":"in"},{"id":"5da54845-1d3f-428a-83ff-17e8e6d883d9","group":"out"}]},"group":null,"attrs":{"border":{"opacity":"1","stroke":"rgb(80, 148, 212)"},"warnImg":{"opacity":"0"}}},{"size":{"width":170,"height":110},"markup":[{"selector":"background","tagName":"rect"},{"selector":"header","tagName":"rect"},{"selector":"cover","tagName":"rect"},{"selector":"border","tagName":"rect"},{"selector":"title","tagName":"text"},{"selector":"appName","tagName":"text"},{"selector":"actionName","tagName":"text"},{"selector":"icon","tagName":"image"},{"selector":"btnDel","tagName":"image"},{"selector":"btnClone","tagName":"image"},{"selector":"warnImg","tagName":"image"},{"selector":"loopImg","tagName":"image"},{"selector":"status","tagName":"text"},{"selector":"asyncIcon","tagName":"image"},{"selector":"btnStar","tagName":"image"}],"angle":0,"z":4,"position":{"x":261,"y":313},"id":"c55ead29-1206-4fc1-96e9-5e2f5bbd7df8","type":"ACTION","ports":{"groups":{"out2":{"markup":[{"selector":"portBody","tagName":"circle"}],"size":{"width":20,"height":20},"z":0,"position":{"args":{"x":90,"y":99},"name":"bottom"},"attrs":{"portBody":{"r":9,"transform":"translate(-10,-10)","fill":"#21ba45","magnet":true}}},"out1":{"markup":[{"selector":"portBody","tagName":"circle"}],"size":{"width":20,"height":20},"z":0,"position":{"args":{"x":174,"y":55},"name":"right"},"attrs":{"portBody":{"r":9,"transform":"translate(-10,-10)","fill":"#21ba45","magnet":true}}},"in2":{"markup":[{"selector":"portBody","tagName":"circle"}],"size":{"width":20,"height":20},"z":0,"position":{"args":{"x":90,"y":5},"name":"top"},"attrs":{"portBody":{"r":9,"transform":"translate(-10,-10)","fill":"#5094D4","magnet":"passive"}}},"in1":{"markup":[{"selector":"portBody","tagName":"circle"}],"size":{"width":20,"height":20},"z":0,"position":{"args":{"x":5,"y":55},"name":"left"},"attrs":{"portBody":{"r":9,"transform":"translate(-10,-10)","fill":"#5094D4","magnet":"passive"}}}},"items":[{"id":"fe4ac221-5d40-474e-8329-106ef883a2f1","group":"in1"},{"id":"660b0e79-624d-47dc-ac4e-d251c5fcf759","group":"in2"},{"id":"a85f8e9b-ea21-4560-9f08-428ae79033c1","group":"out1"},{"id":"63fce6fe-4640-46b3-99c0-c34de9160223","group":"out2"}]},"group":null,"attrs":{"border":{"opacity":"1","stroke":"#52c41a"},"loopImg":{"opacity":"0"},"appName":{"textWrap":{"text":"cve搜索"}},"asyncIcon":{"opacity":"0"},"warnImg":{"opacity":"0"},"header":{"fill":"#52c41a"},"title":{"textWrap":{"text":"获取某个组件的cv"}},"nodeConfig":{"color":"#52c41a","globalVariableList":[],"appName":"cve_search","label":"获取某个组件的cve信息","type":"ACTION","nodeAssetRelationList":[],"configOk":true,"appId":"9591683169347984","appDesc":"cve搜索","name":"c55ead29-1206-4fc1-96e9-5e2f5bbd7df8","actionId":"9591683181470043","parameterConfigList":[{"optionsAction":null,"defaultValue":"","format":null,"description":"查询日期之前的CVE。[ISO 8601为预期格式] 例 2016-03-01","valueGetterType":null,"optionActionKeyPath":null,"concat":null,"type":"STRING","parameterPath":"","required":false,"optionActionValuePath":null,"contains":null,"array":false,"optionsList":null,"name":"before","options":null,"lable":null,"multiSelected":false,"order":0,"assetOptions":null},{"optionsAction":null,"defaultValue":"","format":null,"description":"查询日期之后的CVE。[ISO 8601为预期格式] 例 2016-02-01，默认为当前的前一天","valueGetterType":null,"optionActionKeyPath":null,"concat":null,"type":"STRING","parameterPath":"","required":false,"optionActionValuePath":null,"contains":null,"array":false,"optionsList":null,"name":"after","options":null,"lable":null,"multiSelected":false,"order":1,"assetOptions":null},{"optionsAction":null,"defaultValue":"","format":null,"description":"用逗号分隔的ID的CVE 例 CVE-2017-8797,CVE-2014-0161","valueGetterType":null,"optionActionKeyPath":null,"concat":null,"type":"STRING","parameterPath":"","required":false,"optionActionValuePath":null,"contains":null,"array":false,"optionsList":null,"name":"ids","options":null,"lable":null,"multiSelected":false,"order":2,"assetOptions":null},{"optionsAction":null,"defaultValue":"","format":null,"description":"严重性 low,moderate,important","valueGetterType":null,"optionActionKeyPath":null,"concat":null,"type":"STRING","parameterPath":"important","required":false,"optionActionValuePath":null,"contains":null,"array":false,"optionsList":null,"name":"severity","options":null,"lable":null,"multiSelected":false,"order":3,"assetOptions":null},{"optionsAction":null,"defaultValue":"","format":null,"description":"cve影响的包，例nginx","valueGetterType":null,"optionActionKeyPath":null,"concat":null,"type":"STRING","parameterPath":"${node_433f571489caf39d3c60e483ff5:action_result.data.str_list.*}","required":false,"optionActionValuePath":null,"contains":null,"array":false,"optionsList":null,"name":"package","options":null,"lable":null,"multiSelected":false,"order":4,"assetOptions":null},{"optionsAction":null,"defaultValue":"","format":null,"description":"影响的产品，该参数支持Perl兼容的正则表达式，例 openstack","valueGetterType":null,"optionActionKeyPath":null,"concat":null,"type":"STRING","parameterPath":"","required":false,"optionActionValuePath":null,"contains":null,"array":false,"optionsList":null,"name":"product","options":null,"lable":null,"multiSelected":false,"order":5,"assetOptions":null},{"optionsAction":null,"defaultValue":"","format":null,"description":"CVSS得分大于或等于该值的CVE，例 7.0","valueGetterType":null,"optionActionKeyPath":null,"concat":null,"type":"STRING","parameterPath":"","required":false,"optionActionValuePath":null,"contains":null,"array":false,"optionsList":null,"name":"cvss_score","options":null,"lable":null,"multiSelected":false,"order":6,"assetOptions":null},{"optionsAction":null,"defaultValue":"","format":null,"description":"CVSSv3得分大于或等于此值的CVE 例 7.0","valueGetterType":null,"optionActionKeyPath":null,"concat":null,"type":"STRING","parameterPath":"","required":false,"optionActionValuePath":null,"contains":null,"array":false,"optionsList":null,"name":"cvss3_score","options":null,"lable":null,"multiSelected":false,"order":7,"assetOptions":null},{"optionsAction":null,"defaultValue":"1","format":null,"description":"分页，页数","valueGetterType":null,"optionActionKeyPath":null,"concat":null,"type":"INTEGER","parameterPath":"1","required":false,"optionActionValuePath":null,"contains":null,"array":false,"optionsList":null,"name":"page","options":null,"lable":null,"multiSelected":false,"order":8,"assetOptions":null},{"optionsAction":null,"defaultValue":"10","format":null,"description":"分页大小","valueGetterType":null,"optionActionKeyPath":null,"concat":null,"type":"INTEGER","parameterPath":"5","required":false,"optionActionValuePath":null,"contains":null,"array":false,"optionsList":null,"name":"per_page","options":null,"lable":null,"multiSelected":false,"order":9,"assetOptions":null}],"quartzEtl":null,"config":{"asyncConfig":{}},"actionDesc":"获取某个组件的cve信息","group":null,"resultVariableList":[{"contains":null,"valueType":"STRING","description":"cve","dataPath":"action_result.data.records.*.CVE","exampleValues":null},{"contains":null,"valueType":"STRING","description":"severity","dataPath":"action_result.data.records.*.severity","exampleValues":null},{"contains":null,"valueType":"STRING","description":"public_date","dataPath":"action_result.data.records.*.public_date","exampleValues":null},{"contains":null,"valueType":"JSONARRAY","description":"advisories","dataPath":"action_result.data.records.*.advisories","exampleValues":null},{"contains":null,"valueType":"STRING","description":"bugzilla","dataPath":"action_result.data.records.*.bugzilla","exampleValues":null},{"contains":null,"valueType":"STRING","description":"bugzilla_description","dataPath":"action_result.data.records.*.bugzilla_description","exampleValues":null},{"contains":null,"valueType":"STRING","description":"cvss_score","dataPath":"action_result.data.records.*.cvss_score","exampleValues":null},{"contains":null,"valueType":"STRING","description":"cvss_scoring_vector","dataPath":"action_result.data.records.*.cvss_scoring_vector","exampleValues":null},{"contains":null,"valueType":"STRING","description":"CWE","dataPath":"action_result.data.records.*.CWE","exampleValues":null},{"contains":null,"valueType":"JSONARRAY","description":"affected_packages","dataPath":"action_result.data.records.*.affected_packages","exampleValues":null},{"contains":null,"valueType":"STRING","description":"resource_url","dataPath":"action_result.data.records.*.resource_url","exampleValues":null},{"contains":null,"valueType":"STRING","description":"cvss3_scoring_vector","dataPath":"action_result.data.records.*.cvss3_scoring_vector","exampleValues":null},{"contains":null,"valueType":"STRING","description":"cvss3_score","dataPath":"action_result.data.records.*.cvss3_score","exampleValues":null}],"actionName":"get_cve"},"actionName":{"textWrap":{"text":"get_cve - 获取某个组件的cve信息"}}}},{"size":{"width":170,"height":110},"markup":[{"selector":"background","tagName":"rect"},{"selector":"header","tagName":"rect"},{"selector":"cover","tagName":"rect"},{"selector":"border","tagName":"rect"},{"selector":"title","tagName":"text"},{"selector":"appName","tagName":"text"},{"selector":"actionName","tagName":"text"},{"selector":"icon","tagName":"image"},{"selector":"btnDel","tagName":"image"},{"selector":"btnClone","tagName":"image"},{"selector":"warnImg","tagName":"image"},{"selector":"loopImg","tagName":"image"},{"selector":"status","tagName":"text"},{"selector":"asyncIcon","tagName":"image"},{"selector":"btnStar","tagName":"image"}],"angle":0,"z":6,"position":{"x":720,"y":147},"id":"036ceac9-b97b-4dea-bf39-8327881a7415","type":"ACTION","ports":{"groups":{"out2":{"markup":[{"selector":"portBody","tagName":"circle"}],"size":{"width":20,"height":20},"z":0,"position":{"args":{"x":90,"y":99},"name":"bottom"},"attrs":{"portBody":{"r":9,"transform":"translate(-10,-10)","fill":"#21ba45","magnet":true}}},"out1":{"markup":[{"selector":"portBody","tagName":"circle"}],"size":{"width":20,"height":20},"z":0,"position":{"args":{"x":174,"y":55},"name":"right"},"attrs":{"portBody":{"r":9,"transform":"translate(-10,-10)","fill":"#21ba45","magnet":true}}},"in2":{"markup":[{"selector":"portBody","tagName":"circle"}],"size":{"width":20,"height":20},"z":0,"position":{"args":{"x":90,"y":5},"name":"top"},"attrs":{"portBody":{"r":9,"transform":"translate(-10,-10)","fill":"#5094D4","magnet":"passive"}}},"in1":{"markup":[{"selector":"portBody","tagName":"circle"}],"size":{"width":20,"height":20},"z":0,"position":{"args":{"x":5,"y":55},"name":"left"},"attrs":{"portBody":{"r":9,"transform":"translate(-10,-10)","fill":"#5094D4","magnet":"passive"}}}},"items":[{"id":"ff64873f-4a05-4334-9a45-14cf2e85f604","group":"in1"},{"id":"f0c19c2d-323b-40e9-88ad-56078f1eec97","group":"in2"},{"id":"e9728186-67bb-4df0-bc4c-631602545feb","group":"out1"},{"id":"9627b30f-e39f-4b98-ab81-97043bd0721b","group":"out2"}]},"group":null,"attrs":{"border":{"opacity":"1","stroke":"#52c41a"},"loopImg":{"opacity":"0"},"appName":{"textWrap":{"text":"cve搜索"}},"asyncIcon":{"opacity":"0"},"warnImg":{"opacity":"0"},"header":{"fill":"#52c41a"},"title":{"textWrap":{"text":"检索完整的CVE详"}},"nodeConfig":{"color":"#52c41a","globalVariableList":[],"appName":"cve_search","label":"检索完整的CVE详细信息","type":"ACTION","nodeAssetRelationList":[],"configOk":true,"appId":"9591683169347984","appDesc":"cve搜索","name":"036ceac9-b97b-4dea-bf39-8327881a7415","actionId":"9591683181601578","parameterConfigList":[{"optionsAction":null,"defaultValue":"","format":null,"description":"cve id 例 CVE-2016-3706","valueGetterType":null,"optionActionKeyPath":null,"concat":null,"type":"STRING","parameterPath":"${node_d2912064fc196e95e2f5bbd7df8:action_result.data.records.*.CVE}","required":true,"optionActionValuePath":null,"contains":null,"array":false,"optionsList":null,"name":"id","options":null,"lable":null,"multiSelected":false,"order":0,"assetOptions":null}],"quartzEtl":null,"config":{"asyncConfig":{}},"actionDesc":"检索完整的CVE详细信息","group":null,"resultVariableList":[{"contains":null,"valueType":"STRING","description":"threat_severity","dataPath":"action_result.data.threat_severity","exampleValues":null},{"contains":null,"valueType":"STRING","description":"public_date","dataPath":"action_result.data.public_date","exampleValues":null},{"contains":null,"valueType":"JSONOBJECT","description":"bugzilla","dataPath":"action_result.data.bugzilla","exampleValues":null},{"contains":null,"valueType":"JSONOBJECT","description":"cvss3","dataPath":"action_result.data.cvss3","exampleValues":null},{"contains":null,"valueType":"STRING","description":"cwe","dataPath":"action_result.data.cwe","exampleValues":null},{"contains":null,"valueType":"STRING","description":"details","dataPath":"action_result.data.details","exampleValues":null},{"contains":null,"valueType":"JSONARRAY","description":"affected_release","dataPath":"action_result.data.affected_release","exampleValues":null},{"contains":null,"valueType":"JSONARRAY","description":"package_state","dataPath":"action_result.data.package_state","exampleValues":null},{"contains":null,"valueType":"STRING","description":"upstream_fix","dataPath":"action_result.data.upstream_fix","exampleValues":null},{"contains":null,"valueType":"STRING","description":"references","dataPath":"action_result.data.references","exampleValues":null},{"contains":null,"valueType":"STRING","description":"name","dataPath":"action_result.data.name","exampleValues":null},{"contains":null,"valueType":"BOOLEAN","description":"csaw","dataPath":"action_result.data.csaw","exampleValues":null}],"actionName":"get_cve_details"},"actionName":{"textWrap":{"text":"get_cve_details - 检索完整的CVE详细信息"}}}},{"size":{"width":170,"height":110},"markup":[{"selector":"background","tagName":"rect"},{"selector":"header","tagName":"rect"},{"selector":"cover","tagName":"rect"},{"selector":"border","tagName":"rect"},{"selector":"title","tagName":"text"},{"selector":"appName","tagName":"text"},{"selector":"actionName","tagName":"text"},{"selector":"icon","tagName":"image"},{"selector":"btnDel","tagName":"image"},{"selector":"btnClone","tagName":"image"},{"selector":"warnImg","tagName":"image"},{"selector":"loopImg","tagName":"image"},{"selector":"status","tagName":"text"},{"selector":"asyncIcon","tagName":"image"},{"selector":"btnStar","tagName":"image"}],"angle":0,"z":12,"position":{"x":261,"y":145},"id":"cfa15433-f571-489c-af39-d3c60e483ff5","type":"ACTION","ports":{"groups":{"out2":{"markup":[{"selector":"portBody","tagName":"circle"}],"size":{"width":20,"height":20},"z":0,"position":{"args":{"x":90,"y":99},"name":"bottom"},"attrs":{"portBody":{"r":9,"transform":"translate(-10,-10)","fill":"#21ba45","magnet":true}}},"out1":{"markup":[{"selector":"portBody","tagName":"circle"}],"size":{"width":20,"height":20},"z":0,"position":{"args":{"x":174,"y":55},"name":"right"},"attrs":{"portBody":{"r":9,"transform":"translate(-10,-10)","fill":"#21ba45","magnet":true}}},"in2":{"markup":[{"selector":"portBody","tagName":"circle"}],"size":{"width":20,"height":20},"z":0,"position":{"args":{"x":90,"y":5},"name":"top"},"attrs":{"portBody":{"r":9,"transform":"translate(-10,-10)","fill":"#5094D4","magnet":"passive"}}},"in1":{"markup":[{"selector":"portBody","tagName":"circle"}],"size":{"width":20,"height":20},"z":0,"position":{"args":{"x":5,"y":55},"name":"left"},"attrs":{"portBody":{"r":9,"transform":"translate(-10,-10)","fill":"#5094D4","magnet":"passive"}}}},"items":[{"id":"208d26f8-f7fc-4f84-94c0-ca0947ae9b8b","group":"in1"},{"id":"ae7d4915-d651-496e-8275-5842ee084844","group":"in2"},{"id":"959e0e9a-bfe9-4bd0-8d57-60f74ebb3f98","group":"out1"},{"id":"2e7ca64c-bd88-4c71-bc90-4a25a6900270","group":"out2"}]},"group":null,"attrs":{"border":{"opacity":"1","stroke":"#13c2c2"},"loopImg":{"opacity":"0"},"appName":{"textWrap":{"text":"工具箱"}},"asyncIcon":{"opacity":"0"},"warnImg":{"opacity":"0"},"header":{"fill":"#13c2c2"},"title":{"textWrap":{"text":"填写关注的组件"}},"nodeConfig":{"color":"#13c2c2","globalVariableList":[],"appName":"wzTools","label":"填写关注的组件","type":"ACTION","nodeAssetRelationList":[],"configOk":true,"appId":"9479849727764126","appDesc":"工具箱","name":"cfa15433-f571-489c-af39-d3c60e483ff5","actionId":"9479849742574990","parameterConfigList":[{"optionsAction":null,"defaultValue":"","format":null,"description":"完整的字符串","valueGetterType":null,"optionActionKeyPath":null,"concat":null,"type":"STRING","parameterPath":"redis,fortigate","required":true,"optionActionValuePath":null,"contains":null,"array":false,"optionsList":null,"name":"str_data","options":null,"lable":null,"multiSelected":false,"order":0,"assetOptions":null},{"optionsAction":null,"defaultValue":",","format":null,"description":"切割符","valueGetterType":null,"optionActionKeyPath":null,"concat":null,"type":"STRING","parameterPath":",","required":true,"optionActionValuePath":null,"contains":null,"array":false,"optionsList":null,"name":"sep","options":null,"lable":null,"multiSelected":false,"order":1,"assetOptions":null}],"quartzEtl":null,"config":{"asyncConfig":{}},"actionDesc":"根据切割符对字符串进行切割","group":null,"resultVariableList":[{"contains":null,"valueType":"STRING","description":"切割后的字符串列表","dataPath":"action_result.data.str_list.*","exampleValues":null}],"actionName":"split"},"actionName":{"textWrap":{"text":"split - 根据切割符对字符串进行切割"}}}},{"size":{"width":170,"height":110},"markup":[{"selector":"background","tagName":"rect"},{"selector":"header","tagName":"rect"},{"selector":"cover","tagName":"rect"},{"selector":"border","tagName":"rect"},{"selector":"title","tagName":"text"},{"selector":"appName","tagName":"text"},{"selector":"actionName","tagName":"text"},{"selector":"icon","tagName":"image"},{"selector":"btnDel","tagName":"image"},{"selector":"btnClone","tagName":"image"},{"selector":"warnImg","tagName":"image"},{"selector":"loopImg","tagName":"image"},{"selector":"status","tagName":"text"},{"selector":"asyncIcon","tagName":"image"},{"selector":"btnStar","tagName":"image"}],"angle":0,"z":14,"position":{"x":955,"y":145},"id":"146791a0-e4e1-4d4d-b4f3-f2db0fddfd87","type":"ACTION","ports":{"groups":{"out2":{"markup":[{"selector":"portBody","tagName":"circle"}],"size":{"width":20,"height":20},"z":0,"position":{"args":{"x":90,"y":99},"name":"bottom"},"attrs":{"portBody":{"r":9,"transform":"translate(-10,-10)","fill":"#21ba45","magnet":true}}},"out1":{"markup":[{"selector":"portBody","tagName":"circle"}],"size":{"width":20,"height":20},"z":0,"position":{"args":{"x":174,"y":55},"name":"right"},"attrs":{"portBody":{"r":9,"transform":"translate(-10,-10)","fill":"#21ba45","magnet":true}}},"in2":{"markup":[{"selector":"portBody","tagName":"circle"}],"size":{"width":20,"height":20},"z":0,"position":{"args":{"x":90,"y":5},"name":"top"},"attrs":{"portBody":{"r":9,"transform":"translate(-10,-10)","fill":"#5094D4","magnet":"passive"}}},"in1":{"markup":[{"selector":"portBody","tagName":"circle"}],"size":{"width":20,"height":20},"z":0,"position":{"args":{"x":5,"y":55},"name":"left"},"attrs":{"portBody":{"r":9,"transform":"translate(-10,-10)","fill":"#5094D4","magnet":"passive"}}}},"items":[{"id":"fa1fbb18-074a-48c2-a2de-cedc4b13c988","group":"in1"},{"id":"f71a93c7-91ce-4c30-b94e-368f47c599b2","group":"in2"},{"id":"e350a9ef-8093-4565-bfdc-d7a9df7311d5","group":"out1"},{"id":"5ba89507-ab22-4b6a-993b-fba2292eecc0","group":"out2"}]},"group":null,"attrs":{"border":{"opacity":"1","stroke":"#1890ff"},"loopImg":{"opacity":"0"},"appName":{"textWrap":{"text":"协同办公-钉钉"}},"asyncIcon":{"opacity":"0"},"warnImg":{"opacity":"0"},"header":{"fill":"#1890ff"},"title":{"textWrap":{"text":"发送markdow"}},"nodeConfig":{"color":"#1890ff","globalVariableList":[],"appName":"dingtalk","label":"发送markdown格式消息","type":"ACTION","nodeAssetRelationList":[{"assetId":"5162923800229385"}],"configOk":true,"appId":798154368037659,"appDesc":"协同办公-钉钉","name":"146791a0-e4e1-4d4d-b4f3-f2db0fddfd87","actionId":"7458037931386249","parameterConfigList":[{"optionsAction":null,"defaultValue":null,"format":null,"description":"接收人(,分割)","valueGetterType":null,"optionActionKeyPath":null,"concat":null,"type":"STRING","parameterPath":null,"required":false,"optionActionValuePath":null,"contains":null,"array":false,"optionsList":null,"name":"receiver","options":null,"lable":null,"multiSelected":false,"order":0,"assetOptions":null},{"optionsAction":null,"defaultValue":null,"format":null,"description":"首屏会话透出的展示内容","valueGetterType":null,"optionActionKeyPath":null,"concat":null,"type":"STRING","parameterPath":"漏洞提醒","required":true,"optionActionValuePath":null,"contains":null,"array":false,"optionsList":null,"name":"title","options":null,"lable":null,"multiSelected":false,"order":1,"assetOptions":null},{"optionsAction":null,"defaultValue":null,"format":null,"description":"markdown格式的消息内容","valueGetterType":null,"optionActionKeyPath":null,"concat":null,"type":"STRING","parameterPath":">组件名：${node_433f571489caf39d3c60e483ff5:action_result.data.str_list.*}\n\n\n>id：${node_d2912064fc196e95e2f5bbd7df8:action_result.data.records.*.CVE}\n\n\n>描述：${node_d2912064fc196e95e2f5bbd7df8:action_result.data.records.*.bugzilla_description}\n\n\n>修复的版本：${node_ac9b97b4deabf398327881a7415:action_result.data.upstream_fix}\n\n\n>详情：${node_ac9b97b4deabf398327881a7415:action_result.data.details}\n\n\n>查看更多：[链接](${node_d2912064fc196e95e2f5bbd7df8:action_result.data.records.*.resource_url})","required":true,"optionActionValuePath":null,"contains":null,"array":false,"optionsList":null,"name":"content","options":null,"lable":null,"multiSelected":false,"order":2,"assetOptions":null}],"quartzEtl":null,"config":{"asyncConfig":{}},"actionDesc":"发送markdown格式消息","group":null,"resultVariableList":[{"contains":null,"valueType":"STRING","description":"状态码","dataPath":"action_result.summary.statusCode","exampleValues":null},{"contains":null,"valueType":"STRING","description":"原因","dataPath":"action_result.summary.reason","exampleValues":null},{"contains":null,"valueType":"STRING","description":"结果","dataPath":"action_result.data.result","exampleValues":null}],"actionName":"sendMarkdownMessage"},"actionName":{"textWrap":{"text":"sendMarkdownMessage - 发送markdown格式..."}}}},{"size":{"width":60,"height":60},"markup":[{"selector":"background","tagName":"polygon"},{"selector":"border","tagName":"polygon"},{"selector":"label","tagName":"text"},{"selector":"btnDel","tagName":"image"},{"selector":"btnClone","tagName":"image"},{"selector":"warnImg","tagName":"image"},{"selector":"status","tagName":"text"},{"selector":"btnStar","tagName":"image"}],"angle":0,"z":16,"position":{"x":501,"y":318},"id":"4f982fcf-e7f7-4d22-b73b-ae595c6100c3","type":"SIMPLE_RULE","ports":{"groups":{"out0":{"markup":[{"selector":"portBody","tagName":"circle"}],"size":{"width":20,"height":20},"z":10,"position":{"args":{"x":90,"y":95},"name":"bottom"},"label":{"position":{"args":{"offset":0,"x":-6,"y":-23,"attrs":{"text":{"text":"0","fill":"#1890ff","fontWeight":500}}}}},"attrs":{"portBody":{"r":9,"transform":"translate(-10,-10)","fill":"#1890ff","magnet":true}}},"out1":{"markup":[{"selector":"portBody","tagName":"circle"}],"size":{"width":20,"height":20},"z":10,"position":{"args":{"x":174,"y":50},"name":"right"},"label":{"position":{"args":{"offset":0,"x":-24,"y":-9,"attrs":{"text":{"text":"1","fill":"#5cc05c","fontWeight":500}}}}},"attrs":{"portBody":{"r":9,"transform":"translate(-10,-10)","fill":"#5cc05c","magnet":true}}},"in1":{"markup":[{"selector":"portBody","tagName":"circle"}],"size":{"width":20,"height":20},"z":10,"position":{"args":{"x":5,"y":50},"name":"left"},"attrs":{"portBody":{"r":9,"transform":"translate(-10,-10)","fill":"#5094D4","magnet":"passive"}}}},"items":[{"id":"88f8b2f3-af87-4f46-ac08-ce34e7a3da3a","group":"in1"},{"id":"54a99ef1-8231-4c3c-bb8f-bed31a6448dc","group":"out0"},{"id":"daf29d9f-0fe8-4dbf-8111-496955b914da","group":"out1"}]},"group":null,"attrs":{"border":{"opacity":"1","stroke":"rgb(118,114,164)"},"warnImg":{"opacity":"0"},"label":{"textWrap":{"text":"{ 有新数据 }"}},"nodeConfig":{"globalVariableList":[],"configOk":true,"ruleSetInfo":{"business":{"name":"node_fcfe7f74d22b73bae595c6100c3"},"rules":[{"mode":"NEW","newLevel":1,"is_template":"FALSE","level":1,"name":"4f982fcf-e7f7-4d22-b73b-ae595c6100c3_0","description":"4f982fcf-e7f7-4d22-b73b-ae595c6100c3_0","needCheck":false,"type":"NORMAL","content":{"conditionExpression":"#","conditions":[{"comparator":{"code":"{this} != null && {this}.trim().length()>0","selectedLabel":"不为空","paramCount":0,"name":"isNotNull","label":"不为空","type":"STRING","params":[],"key":"1_isNotNull"},"variable":{"componentType":null,"pointer":{"variableName":null,"method":null,"propertyName":"pno_409225d230a1d80cd85bbf4a9e476659","valueType":"STRING","variable":{"componentType":null,"pointer":{"variableName":"playbook_1deeb6e7c9c01ce06645de1dd20c6194","method":null,"propertyName":null,"valueType":"playbook_1deeb6e7c9c01ce06645de1dd20c6194","variable":null,"frozen":false,"type":"SELF"},"expression":null,"objects":null,"bindType":null,"frozen":false,"collection":null,"type":"POINTER","uuid":null,"inExpression":false,"valueType":"playbook_1deeb6e7c9c01ce06645de1dd20c6194","bindDomain":null,"value":null},"frozen":false,"bindDomain":null,"type":"PROPERTY"},"expression":null,"objects":null,"bindType":null,"frozen":false,"collection":null,"type":"POINTER","uuid":null,"inExpression":false,"valueType":"STRING","bindDomain":null,"value":null,"key":"5_playbook_1deeb6e7c9c01ce06645de1dd20c6194_pno_409225d230a1d80cd85bbf4a9e476659"},"frozen":false,"exp":"并且","uuid":"14164f8bd6b66ee2a07aaaf20a808f5f"}],"actions":[{"isNotDisplay":false,"isScoreCard":false,"selectedLabel":"设置","setProperty":"level","setValue":{"itemType":null,"inExpression":false,"expression":null,"valueType":"INTEGER","firstObject":false,"bindType":"INTEGER","bindDomain":null,"frozen":false,"type":"CONSTANT","follow":false,"value":"1"},"variable":{"itemType":null,"inExpression":false,"pointer":{"variableName":"ruleExecResult","propertyName":null,"valueType":"RuleExecResult","frozen":true,"bindDomain":null,"type":"SELF"},"expression":null,"valueType":"RuleExecResult","firstObject":true,"bindType":null,"bindDomain":null,"frozen":true,"type":"POINTER","follow":false,"value":null},"frozen":true,"type":"SETPROPERTY"}]},"snapshot":{"conditionStr":"获取某个组件的cve信息的出参:cve (action_result.data.records.*.CVE)  不为空  ","actionStr":"设置执行结果数值为1"}}],"model":{"name":"playbook_1deeb6e7c9c01ce06645de1dd20c6194","model_properties":[{"name":"pno_409225d230a1d80cd85bbf4a9e476659","isGlobalVariable":false,"label":"获取某个组件的cve信息的出参:cve (action_result.data.records.*.CVE)","type":{"realType":"STRING","type":"STRING","desc":"字符串"}}],"label":"剧本"}},"name":"4f982fcf-e7f7-4d22-b73b-ae595c6100c3","typeChanged":false,"usedGlobalVariables":[],"parameterConfigList":[{"name":"playbook_1deeb6e7c9c01ce06645de1dd20c6194.pno_409225d230a1d80cd85bbf4a9e476659","description":"获取某个组件的cve信息的出参:cve (action_result.data.records.*.CVE)","valueGetterType":null,"type":"STRING","parameterPath":"${node_d2912064fc196e95e2f5bbd7df8:action_result.data.records.*.CVE}","required":true,"hasBound":true}],"label":"有新数据","type":"SIMPLE_RULE","group":null,"resultVariableList":[{"valueType":"INTEGER","description":"数值","label":"数值","dataPath":"RuleExecResult.level"}]}}}]},"publishStatus":"ONLINE","extraInfo":{"node_ac9b97b4deabf398327881a7415":{"assetList":[],"displayName":"检索完整的CVE详细信息","globalParamExtra":{"assignRoleIdList":[],"assignUsernameList":[],"paramNameCefListMap":{},"paramNameFuncMethodMap":{},"paramNameRelyNodeSetMap":{}},"inputParamExtra":{"assignRoleIdList":[],"assignUsernameList":[],"paramNameCefListMap":{},"paramNameFuncMethodMap":{},"paramNameRelyNodeSetMap":{}},"nestPlaybook":null},"node_d2912064fc196e95e2f5bbd7df8":{"assetList":[],"displayName":"获取某个组件的cve信息","globalParamExtra":{"assignRoleIdList":[],"assignUsernameList":[],"paramNameCefListMap":{},"paramNameFuncMethodMap":{},"paramNameRelyNodeSetMap":{}},"inputParamExtra":{"assignRoleIdList":[],"assignUsernameList":[],"paramNameCefListMap":{},"paramNameFuncMethodMap":{},"paramNameRelyNodeSetMap":{}},"nestPlaybook":null},"node_2afcb7245888ac9984ca3603f39":{"assetList":[],"displayName":"结束","globalParamExtra":null,"inputParamExtra":null,"nestPlaybook":null},"node_fcfe7f74d22b73bae595c6100c3":{"assetList":[],"displayName":"有新数据","globalParamExtra":{"assignRoleIdList":[],"assignUsernameList":[],"paramNameCefListMap":{},"paramNameFuncMethodMap":{},"paramNameRelyNodeSetMap":{}},"inputParamExtra":{"assignRoleIdList":[],"assignUsernameList":[],"paramNameCefListMap":{},"paramNameFuncMethodMap":{},"paramNameRelyNodeSetMap":{}},"nestPlaybook":null},"node_7d310db4c18aef69f3e8945aa47":{"assetList":[],"displayName":"开始","globalParamExtra":null,"inputParamExtra":{"assignRoleIdList":[],"assignUsernameList":[],"paramNameCefListMap":{},"paramNameFuncMethodMap":{},"paramNameRelyNodeSetMap":{}},"nestPlaybook":null},"node_433f571489caf39d3c60e483ff5":{"assetList":[],"displayName":"填写关注的组件","globalParamExtra":{"assignRoleIdList":[],"assignUsernameList":[],"paramNameCefListMap":{},"paramNameFuncMethodMap":{},"paramNameRelyNodeSetMap":{}},"inputParamExtra":{"assignRoleIdList":[],"assignUsernameList":[],"paramNameCefListMap":{},"paramNameFuncMethodMap":{},"paramNameRelyNodeSetMap":{}},"nestPlaybook":null},"node_1a0e4e14d4db4f3f2db0fddfd87":{"assetList":[{"actionEngineType":null,"actionPermissionMap":{},"appId":null,"approveConfigJson":null,"assetSettingList":[{"name":"token","type":"PASSWORD","value":"xyi8mZdKkl6yNY5YE5W0wcbtZss+n0cuJTcp7jUreZfR3Y+MxJThFkyL6kbAC72QI2UKnQsEq9r2bZAzioPGDovDeWXiwiLvUVz63nV4poM="},{"name":"secret","type":"PASSWORD","value":"XJTyZq7Ui5xSazhcFJZr7s2kjPXHQD+0jtY+z7Wxt/IHKuZOvqiki8nwhURTnGLYCknGFK+p1i49udbh5hfT82/oFxOzqZ1nzPp2BdWL2io="},{"name":"receiver","type":"STRING","value":null}],"assetSettingListJson":"[{\"name\":\"token\",\"type\":\"PASSWORD\",\"value\":\"xyi8mZdKkl6yNY5YE5W0wcbtZss+n0cuJTcp7jUreZfR3Y+MxJThFkyL6kbAC72QI2UKnQsEq9r2bZAzioPGDovDeWXiwiLvUVz63nV4poM=\"},{\"name\":\"secret\",\"type\":\"PASSWORD\",\"value\":\"XJTyZq7Ui5xSazhcFJZr7s2kjPXHQD+0jtY+z7Wxt/IHKuZOvqiki8nwhURTnGLYCknGFK+p1i49udbh5hfT82/oFxOzqZ1nzPp2BdWL2io=\"},{\"name\":\"receiver\",\"type\":\"STRING\",\"value\":null}]","createTime":null,"createdBy":null,"deleted":null,"description":null,"healthStatus":null,"id":null,"lastHealthCheckTime":null,"modifiedBy":null,"name":null,"owner":null,"productName":null,"productVendor":null,"status":null,"updateTime":null}],"displayName":"发送markdown格式消息","globalParamExtra":{"assignRoleIdList":[],"assignUsernameList":[],"paramNameCefListMap":{},"paramNameFuncMethodMap":{},"paramNameRelyNodeSetMap":{}},"inputParamExtra":{"assignRoleIdList":[],"assignUsernameList":[],"paramNameCefListMap":{},"paramNameFuncMethodMap":{},"paramNameRelyNodeSetMap":{}},"nestPlaybook":null}}}
